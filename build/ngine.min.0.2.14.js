/*! Ngine v1.0.0 | (c) Christian Westman | GNU General Public License v3.0 | https://github.com/creamdog/ngine */
"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}window.$ngine={cache:{},state:{},interpolate:function(e,n,t,r,i){i=void 0===i?0:i,t=void 0===t?0:t;var o=0;t+=e.substr(0,o).split("\n").length;for(var a=-1,l=!1,c=!1,u=null,d=[],s=["'",'"',"`"],f=null,g=o,p=0,h=function(){var n=e[v];if(u=null==u?s.filter(function(e){return e==n})[0]:n==u?null:u,s.filter(function(e){return e==n})[0]&&(d[d.length-1]==n?d.pop():d.push(n)),"{"==n&&l&&(o=c?o:v,c&&(a++,p++),c=!0),"{"==n&&!l&&c&&p++,l="$"==n,"}"==n&&0==p&&c&&0==Math.max(0,a-1)){if(0==(a=Math.max(0,a-1))&&c)return f=e.substr(o+1,v-o-1),g=o+f.length+2,"break"}else"}"==n&&(a=Math.max(0,a-1),p=Math.max(0,p-1))},v=o;v<e.length;v++){if("break"===h())break}if(!f)return e.toString();if(f=$ngine.interpolate(f,n,t,r,i+1),f=null!=u&&i>0?u+"+ ( "+f+" ) +"+u:f,i>0)return $ngine.interpolate(e.substr(0,o-1)+f+e.substr(g),n,t,r,i+1);var m=e.substr(0,o-1)+n(f,t,r)+e.substr(g);return $ngine.interpolate(m,n,t,r).toString()},load:function(e,n,t,r){var i=new XMLHttpRequest;i.addEventListener("load",function(t){var i=t.target.getResponseHeader("content-type")||"",o=function(){var n=404==t.target.status?'{ "error" : "404 not found \''+e+"' \" }":t.target.responseText;return n=i.indexOf("application/json")>=0?JSON.parse(n):n,r?{model:n,url:e}:n}(),a=t.target.id;return n(o,a)}),i.id=t,i.open("GET",e),i.send()},reload:function(e){var n=$ngine.cache[e].model,t="function"==typeof n?function(e){n(e)}:"string"==typeof n?function(t){$ngine.load(n,t,e,!0)}:function(e){e(n)};$ngine.render($ngine.cache[e].url,t,function(n,t){var r=$ngine.cache[e].elements[0],i=document.createElement("div");r.parentNode.insertBefore(i,r);for(var o=0;o<$ngine.cache[e].elements.length;o++){var a=$ngine.cache[e].elements[o];a.parentNode.removeChild(a)}$ngine.apply(i,t,n)})},apply:function(e,n,t){if(void 0!==e&&null!=e)if(e.outerHTML){e.innerHTML=t,$ngine.cache[n].elements=[];for(var r=0;r<e.childNodes.length;r++)$ngine.cache[n].elements.push(e.childNodes[r]);for(var i=0;i<$ngine.cache[n].elements.length;i++){var o=$ngine.cache[n].elements[i];o.parentNode.removeChild(o),e.parentNode.insertBefore(o,e)}e.parentNode.removeChild(e);var a=$ngine.cache[n].elements.filter(function(e){return"SCRIPT"==e.nodeName}),l=a.filter(function(e){return null!=e.getAttribute("src")}),c=a.filter(function(e){return e.innerHTML.trim().length>0}),u=l.length,d=function(e,n){return function(){--e<=0&&n.forEach(function(e){e.parentNode.removeChild(e);var n=document.createElement("script");n.setAttribute("type","text/javascript"),n.innerHTML=e.innerHTML,document.body.appendChild(n)})}}(u,c);0==u&&d(),l.forEach(function(e){e.parentNode.removeChild(e);var n=document.createElement("script");n.setAttribute("src",e.getAttribute("src")),n.setAttribute("type","text/javascript"),n.addEventListener("load",d),document.body.appendChild(n)})}else{var s=document.createElement("div");s.innerHTML="\x3c!--8a002e27-eca8-4fdc-9b1b-41d2c1468d5f--\x3e";var f=e.parentNode;f.replaceChild(s,e),f.innerHTML=f.innerHTML.replace("<div>"+s.innerHTML+"</div>",t)}else console.log("unable to ngine.apply:",n)},util:{string:{flatten:function(e){for(var n=!1,t="",r=['"',"'","`"],i=void 0,o=0;o<e.length;o++){var a=e[o];n=(!n||"`"!=a)&&("`"==a||n),i=void 0===i?r[r.indexOf(a)]:i==r[r.indexOf(a)]?void 0:i,"\r"==a||(t+="\n"==a&&void 0!==i?"\\n":"`"==a?'"':'"'==a&&n?'\\"':a)}return console.log("flattened",t),t}}},eval:function(e,n,t){var r=t.model,i=t.url;e=$ngine.util.string.flatten(e),console.log(e);try{var o=Object.keys(r),a=Object.keys(r).map(function(e){return r[e]});o.push("render"),a.push(function(e,n){var r=void 0===n;return n=void 0===n?t.getModel:n,$ngine.render(e,n,function(e,n){var t=document.getElementById(n);$ngine.apply(t,n,e)},r?t:void 0)});var l="function("+o.join(",")+"){ return ("+e+") }";return Function('"use strict";return ('+l+")")().apply(void 0,_toConsumableArray(a))}catch(t){return console.log({message:t.message,expression:e,line:n,file:i,exception:t}),'{{  "'+t.message+'"  }}'}},navigate:function(e,n,t){return window.location.hash="#!"+e,$ngine.cache[e]={model:n,callback:t},$ngine.render(e,n,t)},render:function(e,n,t,r){console.log("render",e,n);var i=1e5+Math.floor(1e5*Math.random())+"_"+(new Date).getTime(),o="function"==typeof e?function(n){return e(function(e){return n(e,i)})}:function(n){return $ngine.load(e,n,i)},a=r&&r.getModel?r.getModel:"function"==typeof n?function(e){n(e)}:"string"==typeof n?function(e){$ngine.load(n,e,i,!0)}:function(e){e(n)};return o(function(r,i){$ngine.cache[i]={url:e,elements:[],model:n},a(function(e,n){var o={url:n,model:e,getModel:a,cache:{},id:i};e._ngine_template_id_=i,e._ngine_template_url_=n;for(var l=$ngine.interpolate(r,$ngine.eval,0,o).toString(),c=function e(n){if(void 0===n)return[];if("function"==typeof n)return[n];if("string"==typeof n){if("#"==n[0])return[document.getElementById(n.substr(1))];if("."==n[0]){for(var t=[],r=document.getElementsByClassName(n.substr(1)),i=0;i<r.length;i++)t.push(r[i]);return t}for(var o=[],a=document.getElementsByTagName(n),l=0;l<a.length;l++)o.push(a[l]);return o}if(Array.isArray(n))return[].concat.apply([],n.map(e));console.log("invalid ngine.render callback:",n)}(t),u=0;u<c.length;u++){var d=c[u];if("function"!=typeof d){d.innerHTML="";var s=document.createElement("div");d.appendChild(s),$ngine.apply(s,i,l)}else d(l,i)}})}),'<span id="'+i+'">loading..</span>'}},window.addEventListener("hashchange",function(){if(0==window.location.hash.indexOf("#!")){var e=window.location.hash.substr(2),n=$ngine.cache[e]?$ngine.cache[e].model:{},t=$ngine.cache[e]?$ngine.cache[e].callback:"body";$ngine.render(e,n,t)}},!1),$ngine.version="0.2.14";
